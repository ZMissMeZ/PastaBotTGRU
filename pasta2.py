# bot_pasta.py
import asyncio
import json
import random
import re
import logging
from collections import deque
from aiogram import Bot, Dispatcher
from aiogram.filters import Command
from aiogram.types import Message
from pyrogram import Client
from pyrogram.types import Message as PyMessage
from bs4 import BeautifulSoup
import requests

# ‚îÄ‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
BOT_TOKEN = "8520620674:AAEI6e3RC61QKoZhxI4QOxxRoTtMS0NdN0M"
JSON_FILE = "result.json"
API_ID = 37663298  # ‚Üê –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π API_ID
API_HASH = "e95ae41cc104070a17d8e8a28484e21d"  # ‚Üê –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π API_HASH

SPECIAL_USER_DROCHIT = 936315572
SPECIAL_USER_PSRAL = 1328231117
MIN_LENGTH = 20
RECENT_LIMIT = 10
SPECIAL_CHANCE = 0.5
OTHER_CHANCE = 0.1
GIF_CHANCE = 0.3

CHANNELS = ["rand2ch", "memeskwin"]  # usernames –∫–∞–Ω–∞–ª–æ–≤

logging.basicConfig(level=logging.INFO)
bot = Bot(token=BOT_TOKEN)
dp = Dispatcher()

teyki_list = []
media_cache = []  # –∫—ç—à file_id –º–µ–¥–∏–∞ –∏–∑ –∫–∞–Ω–∞–ª–æ–≤
recently_sent = deque(maxlen=RECENT_LIMIT)

# –†–µ–∞–ª—å–Ω—ã–µ –º–µ–º–Ω—ã–µ –∫–æ–ø–∏–ø–∞—Å—Ç—ã –ø—Ä–æ –°–í–û / ZOV / –ì–û–ô–î–ê (70 —à—Ç—É–∫, 50‚Äì150 —Å–∏–º–≤–æ–ª–æ–≤)
zov_pasty = [
    "–ö–æ–≥–¥–∞ –≤ 3 –Ω–æ—á–∏ –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ –º–æ–±–∏–ª–∏–∑–∞—Ü–∏–∏, –∞ —Ç—ã —É–∂–µ —Ç—Ä–µ—Ç–∏–π –¥–µ–Ω—å –≤ –∑–∞–ø–æ–µ –∏ –¥—É–º–∞–µ—à—å: ¬´–ù—É –≤—Å—ë, –≥–æ–π–¥–∞ –ø–æ –ø–æ–ª–Ω–æ–π¬ª üòÇ",
    "–°–∏–∂—É –Ω–∞ –°–í–û, –µ–º —Å—É—Ö–ø–∞–π, –¥—É–º–∞—é: ¬´–ê –≤–µ–¥—å –º–æ–≥ –±—ã —Å–µ–π—á–∞—Å –≤ –æ—Ñ–∏—Å–µ —Å–∏–¥–µ—Ç—å –∏ Excel –º—É—á–∏—Ç—å¬ª. –ì–æ–π–¥–∞, –±—Ä–∞—Ç—Ü—ã, –≥–æ–π–¥–∞! ü§°",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –º–∞–º–∞ –∑–≤–æ–Ω–∏—Ç –∏ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç ¬´–¢—ã —Ç–∞–º –Ω–µ –∑–∞–º—ë—Ä–∑?¬ª, –∞ —Ç—ã –æ—Ç–≤–µ—á–∞–µ—à—å ¬´–ú–∞–º, —Ç—É—Ç –∂–∞—Ä–∫–æ –æ—Ç –≥–æ–π–¥—ã¬ª üî•",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–≤–æ, —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 4 —É—Ç—Ä–∞ –ø—Ä–æ—Å—ã–ø–∞–µ—à—å—Å—è –æ—Ç –≤–∑—Ä—ã–≤–∞ –∏ –¥—É–º–∞–µ—à—å: ¬´–ù—É –∏ —Ö*—Ä —Å –Ω–∏–º, –∑–∞—Ç–æ –∫—Ä–∞—Å–∏–≤–æ¬ª üí•",
    "–ù–∞ –°–í–û –≥–ª–∞–≤–Ω—ã–π –≤–æ–ø—Ä–æ—Å –Ω–µ ¬´–ó–∞ —á—Ç–æ –≤–æ—é–µ–º?¬ª, –∞ ¬´–ö—Ç–æ —Å–µ–≥–æ–¥–Ω—è –Ω–∞ –¥–µ–∂—É—Ä—Å—Ç–≤–æ –ø–æ –≥—Ä–µ—á–∫–µ?¬ª –ì–æ–π–¥–∞, –≥—Ä–µ—á–∫–∞ –∑–æ–≤—ë—Ç! üç≤",
    "–ö–æ–≥–¥–∞ –æ—Ä–∫ –≤ –æ–∫–æ–ø–µ –∫—Ä–∏—á–∏—Ç ¬´–°–¥–∞–≤–∞–π—Ç–µ—Å—å!¬ª, –∞ —Ç—ã –æ—Ç–≤–µ—á–∞–µ—à—å ¬´–ì–æ–π–¥–∞, —Å–∞–º —Å–¥–∞–≤–∞–π—Å—è, —É –Ω–∞—Å –≥—Ä–µ—á–∫–∞ –∫–æ–Ω—á–∏–ª–∞—Å—å¬ª üñï",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ TikTok —Å–Ω–∏–º–∞—é—Ç ¬´–∫–∞–∫ —è –≤–µ—Ä–Ω—É–ª—Å—è —Å –°–í–û¬ª, –∞ —Ç—ã –µ—â—ë –¥–∞–∂–µ –Ω–µ —É–µ–∑–∂–∞–ª, –Ω–æ —É–∂–µ –º–æ—Ä–∞–ª—å–Ω–æ –≥–æ–π–¥–∏—à—å üòÇ",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥—É—à–∏, –∫–æ–≥–¥–∞ —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ –∫–∞—Ä—Ç—É –∏ –¥—É–º–∞–µ—à—å: ¬´–ê –≤–µ–¥—å –º–æ–∂–Ω–æ –±—ã–ª–æ –≤ –¢—É—Ä—Ü–∏—é, –Ω–æ –Ω–µ—Ç, –≥–æ–π–¥–∞¬ª üèñÔ∏è",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –∂–µ–Ω–∞ –ø–∏—à–µ—Ç ¬´–í–µ—Ä–Ω–∏—Å—å –∂–∏–≤—ã–º¬ª, –∞ —Ç—ã –æ—Ç–≤–µ—á–∞–µ—à—å ¬´–ì–æ–π–¥–∞, –≤–µ—Ä–Ω—É—Å—å —Å —Ç—Ä–æ—Ñ–µ—è–º–∏ –∏ –≥—Ä–µ—á–∫–æ–π¬ª üèÜ",
    "–ö–æ–≥–¥–∞ –∫–æ–º–∞–Ω–¥–∏—Ä –≥–æ–≤–æ—Ä–∏—Ç ¬´–í–ø–µ—Ä—ë–¥!¬ª, –∞ —Ç—ã –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –Ω–æ –ª—É—á—à–µ –±—ã –Ω–∞–∑–∞–¥, —Ç–∞–º —Ç–µ–ø–ª–æ¬ª ‚ùÑÔ∏è",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö –≥–æ–≤–æ—Ä—è—Ç ¬´–æ–ø–µ—Ä–∞—Ü–∏—è –∏–¥—ë—Ç –ø–æ –ø–ª–∞–Ω—É¬ª, –∞ —Ç—ã –≤ –æ–∫–æ–ø–µ –¥—É–º–∞–µ—à—å: ¬´–ß–µ–π –ø–ª–∞–Ω? –ù–µ –º–æ–π —Ç–æ—á–Ω–æ¬ª ü§î",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–ó–∞ –†–æ–¥–∏–Ω—É!¬ª, –∞ –≤ –≥–æ–ª–æ–≤–µ ¬´–õ–∏—à—å –±—ã —Å—É—Ö–ø–∞–π –Ω–µ –∫–æ–Ω—á–∏–ª—Å—è¬ª üçõ",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 5 —É—Ç—Ä–∞ –ø–æ–¥—ä—ë–º, –∞ —Ç—ã —É–∂–µ –º–æ—Ä–∞–ª—å–Ω–æ –Ω–∞ –≥–æ–π–¥–µ —Å 3 –Ω–æ—á–∏ üò¥",
    "–ö–æ–≥–¥–∞ FPV-–¥—Ä–æ–Ω –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç, –∞ —Ç—ã —É—Å–ø–µ–≤–∞–µ—à—å –∫—Ä–∏–∫–Ω—É—Ç—å ¬´–ì–æ–π–¥–∞!¬ª –ø–µ—Ä–µ–¥ –≤–∑—Ä—ã–≤–æ–º ‚Äî –≤–æ—Ç —ç—Ç–æ –ø–æ-–Ω–∞—à–µ–º—É üí£",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –æ—Ç–ø—É—Å–∫–µ —Å–∏–¥–∏—à—å –≤ –±–∞—Ä–µ, –∞ –æ—Ñ–∏—Ü–∏–∞–Ω—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç ¬´–ß—Ç–æ –±—É–¥–µ—Ç–µ?¬ª, –∞ —Ç—ã –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–µ: ¬´–ì—Ä–µ—á–∫–∏ –∏ –≥–æ–π–¥—ã¬ª üç∫",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å –≤ –Ω–µ–±–µ ¬´–†—É—Å—Å–∫–∏–π –≤–æ–µ–Ω–Ω—ã–π —Å–∞–º–æ–ª—ë—Ç¬ª –∏ –¥—É–º–∞–µ—à—å: ¬´–ö—Ä–∞—Å–∞–≤—á–∏–∫, –≥–æ–π–¥–∞!¬ª ‚úàÔ∏è",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –º–∞–º–∞ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –Ω–æ—Å–∫–∏, –∞ —Ç—ã –ø–∏—à–µ—à—å: ¬´–ú–∞–º, —Å–ø–∞—Å–∏–±–æ, –≥–æ–π–¥–∞ –≤ –Ω–æ—Å–∫–∞—Ö —Ç–µ–ø–ª–µ–µ¬ª üß¶",
    "–ö–æ–≥–¥–∞ –æ—Ä–∫ –æ—Ä—ë—Ç ¬´–°–ª–∞–≤–∞ –£–∫—Ä–∞–∏–Ω–µ!¬ª, –∞ —Ç—ã –æ—Ç–≤–µ—á–∞–µ—à—å ¬´–ì–æ–π–¥–∞, –∞ —É –≤–∞—Å –≥—Ä–µ—á–∫–∞ –µ—Å—Ç—å?¬ª üê∑",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ TikTok —Å–Ω–∏–º–∞—é—Ç ¬´–∂–∏–∑–Ω—å –Ω–∞ –°–í–û¬ª, –∞ —Ç—ã —Å–∏–¥–∏—à—å –∏ –¥—É–º–∞–µ—à—å: ¬´–ì–¥–µ –º–æ–π –º–æ–Ω—Ç–∞–∂—ë—Ä, –≥–¥–µ –º–æ—è –º—É–∑—ã–∫–∞?¬ª üé•",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –∫–æ–º–∞–Ω–¥–∏—Ä –≥–æ–≤–æ—Ä–∏—Ç ¬´–ù–∞ –ø–æ–∑–∏—Ü–∏–∏!¬ª, –∞ —Ç—ã —É–∂–µ –º–æ—Ä–∞–ª—å–Ω–æ –Ω–∞ –≥–æ–π–¥–µ –≤ –æ–∫–æ–ø–µ üï≥Ô∏è",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 6 —É—Ç—Ä–∞ –∫–æ—Ñ–µ –∏–∑ —Ç–µ—Ä–º–æ—Å–∞, –∞ –≤ –≥–æ–ª–æ–≤–µ: ¬´–ì–æ–π–¥–∞, –∫–æ—Ñ–µ, –≥–æ–π–¥–∞¬ª ‚òï",
    "–ö–æ–≥–¥–∞ FPV –ø—Ä–æ–ª–µ—Ç–∞–µ—Ç –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π, –∞ —Ç—ã –∫—Ä–∏—á–∏—à—å: ¬´–ì–æ–π–¥–∞, –±—Ä–∞—Ç, –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ!¬ª üöÅ",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö ¬´—É—Å–ø–µ—Ö–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ¬ª, –∞ —É —Ç–µ–±—è —É—Å–ø–µ—Ö ‚Äî —Å—É—Ö–ø–∞–π –Ω–µ –∫–æ–Ω—á–∏–ª—Å—è üéñÔ∏è",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–ó–∞ –†–æ–¥–∏–Ω—É!¬ª, –∞ –≤ –¥—É—à–µ ¬´–ó–∞ –≥—Ä–µ—á–∫—É –∏ —Ç–µ–ø–ª–æ¬ª üî•",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –Ω–æ—á—å—é —Å–ª—ã—à–∏—à—å ¬´–£—Ä–∞!¬ª, –∞ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, —Ç–æ–ª—å–∫–æ –Ω–µ –∫–æ –º–Ω–µ¬ª üò±",
    "–ö–æ–≥–¥–∞ –æ—Ä–∫ –≤ –ø–ª–µ–Ω—É –≥–æ–≤–æ—Ä–∏—Ç ¬´–°–ª–∞–≤–∞ –£–∫—Ä–∞–∏–Ω–µ¬ª, –∞ —Ç—ã: ¬´–ì–æ–π–¥–∞, –∞ —É –Ω–∞—Å –≥—Ä–µ—á–∫–∞¬ª üç≤",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –æ—Ç–ø—É—Å–∫–µ —Å–∏–¥–∏—à—å –∏ —Å–∫—É—á–∞–µ—à—å –ø–æ –æ–∫–æ–ø—É –∏ –≥—Ä–µ—á–∫–µ. –°—Ç—Ä–∞–Ω–Ω–æ, –Ω–æ —Ñ–∞–∫—Ç ü§Ø",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å —Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ñ–ª–∞–≥ –∏ –¥—É–º–∞–µ—à—å: ¬´–ö—Ä–∞—Å–æ—Ç–∞, –≥–æ–π–¥–∞¬ª üá∑üá∫",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 3 –Ω–æ—á–∏ –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç, –∞ —Ç—ã: ¬´–ù—É –∏ —Ö*—Ä —Å –Ω–∏–º, –≥–æ–π–¥–∞¬ª üí•",
    "–ö–æ–≥–¥–∞ –∫–æ–º–∞–Ω–¥–∏—Ä –≥–æ–≤–æ—Ä–∏—Ç ¬´–î–µ—Ä–∂–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é!¬ª, –∞ —Ç—ã –¥–µ—Ä–∂–∏—à—å —Ç–æ–ª—å–∫–æ –≥—Ä–µ—á–∫—É ü•Ñ",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ TikTok ¬´–≥–µ—Ä–æ–∏ –°–í–û¬ª, –∞ —Ç—ã –≥–µ—Ä–æ–π ‚Äî –≤—ã–∂–∏–ª –±–µ–∑ –≥—Ä–µ—á–∫–∏ ü¶∏",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–í –∞—Ç–∞–∫—É!¬ª, –∞ –≤ –≥–æ–ª–æ–≤–µ ¬´–¢–æ–ª—å–∫–æ –±—ã –Ω–µ –≤ –∞—Ç–∞–∫—É –∑–∞ –≥—Ä–µ—á–∫–æ–π¬ª üèÉ",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –º–∞–º–∞ –ø–∏—à–µ—Ç ¬´–ë–µ—Ä–µ–≥–∏ —Å–µ–±—è¬ª, –∞ —Ç—ã: ¬´–ú–∞–º, –≥–æ–π–¥–∞ –±–µ—Ä–µ–∂—ë—Ç¬ª üõ°Ô∏è",
    "–ö–æ–≥–¥–∞ FPV-–¥—Ä–æ–Ω ‚Äî —Ç–≤–æ–π –ª—É—á—à–∏–π –¥—Ä—É–≥, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –≥–æ–π–¥—É –Ω–µ—Å—ë—Ç üöÄ",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –æ—Ç–ø—É—Å–∫–µ —Å–∏–¥–∏—à—å –∏ –¥—É–º–∞–µ—à—å: ¬´–ê –≤–µ–¥—å –º–æ–≥ –±—ã —Å–µ–π—á–∞—Å –≥–æ–π–¥–∏—Ç—å¬ª üçπ",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å —Ñ–ª–∞–≥ –∏ –¥—É–º–∞–µ—à—å: ¬´–ö—Ä–∞—Å–æ—Ç–∞, –≥–æ–π–¥–∞, –≥—Ä–µ—á–∫–∞¬ª üá∑üá∫üçõ",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 5 —É—Ç—Ä–∞ –ø–æ–¥—ä—ë–º, –∞ —Ç—ã —É–∂–µ –Ω–∞ –≥–æ–π–¥–µ —Å 3 –Ω–æ—á–∏ üò¥",
    "–ö–æ–≥–¥–∞ FPV –ø—Ä–æ–ª–µ—Ç–∞–µ—Ç, –∞ —Ç—ã —É—Å–ø–µ–≤–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ!¬ª ‚úàÔ∏è",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ TikTok ¬´–∂–∏–∑–Ω—å –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ¬ª, –∞ —É —Ç–µ–±—è –∂–∏–∑–Ω—å ‚Äî –≥—Ä–µ—á–∫–∞ –∏ –≥–æ–π–¥–∞ üé¨",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–ó–∞ –†–æ–¥–∏–Ω—É!¬ª, –∞ –≤ –¥—É—à–µ ¬´–ó–∞ —Å—É—Ö–ø–∞–π¬ª üçõ",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –Ω–æ—á—å—é —Å–ª—ã—à–∏—à—å –≤–∑—Ä—ã–≤, –∞ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –∫—Ä–∞—Å–∏–≤–æ¬ª üí£",
    "–ö–æ–≥–¥–∞ –æ—Ä–∫ –≤ –ø–ª–µ–Ω—É: ¬´–°–ª–∞–≤–∞ –£–∫—Ä–∞–∏–Ω–µ!¬ª, —Ç—ã: ¬´–ì–æ–π–¥–∞, –≥—Ä–µ—á–∫–∞?¬ª üê∑",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –æ—Ç–ø—É—Å–∫–µ —Å–∏–¥–∏—à—å –∏ —Å–∫—É—á–∞–µ—à—å –ø–æ –æ–∫–æ–ø—É –∏ –≥—Ä–µ—á–∫–µ ü§î",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å —Ñ–ª–∞–≥ –∏ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –º–æ—â–Ω–æ¬ª üí™",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 3 –Ω–æ—á–∏ –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç, –∞ —Ç—ã: ¬´–ì–æ–π–¥–∞¬ª üí•",
    "–ö–æ–≥–¥–∞ –∫–æ–º–∞–Ω–¥–∏—Ä –≥–æ–≤–æ—Ä–∏—Ç ¬´–î–µ—Ä–∂–∞—Ç—å!¬ª, –∞ —Ç—ã –¥–µ—Ä–∂–∏—à—å –≥—Ä–µ—á–∫—É ü•Ñ",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö ¬´–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ¬ª, –∞ —É —Ç–µ–±—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ ‚Äî –¥–æ –≥—Ä–µ—á–∫–∏ üèÉ",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–í–ø–µ—Ä—ë–¥!¬ª, –∞ –¥—É–º–∞–µ—à—å ¬´–¢–æ–ª—å–∫–æ –Ω–µ –∑–∞ –≥—Ä–µ—á–∫–æ–π¬ª üèÉ‚Äç‚ôÇÔ∏è",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –º–∞–º–∞ –ø–∏—à–µ—Ç ¬´–ë–µ—Ä–µ–≥–∏ —Å–µ–±—è¬ª, —Ç—ã: ¬´–ì–æ–π–¥–∞ –±–µ—Ä–µ–∂—ë—Ç¬ª üõ°Ô∏è",
    "–ö–æ–≥–¥–∞ FPV ‚Äî —Ç–≤–æ–π –ª—É—á—à–∏–π –¥—Ä—É–≥, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –≥–æ–π–¥—É –Ω–µ—Å—ë—Ç üöÄ",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –æ—Ç–ø—É—Å–∫–µ —Å–∏–¥–∏—à—å –∏ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –≥–¥–µ –º–æ–π –æ–∫–æ–ø?¬ª üçπ",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å —Ñ–ª–∞–≥ –∏ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –≥—Ä–µ—á–∫–∞¬ª üá∑üá∫üçõ",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 5 —É—Ç—Ä–∞ –∫–æ—Ñ–µ, –∞ –≤ –≥–æ–ª–æ–≤–µ: ¬´–ì–æ–π–¥–∞, –∫–æ—Ñ–µ¬ª ‚òï",
    "–ö–æ–≥–¥–∞ FPV –ø—Ä–æ–ª–µ—Ç–∞–µ—Ç, –∞ —Ç—ã: ¬´–ì–æ–π–¥–∞, –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ!¬ª ‚úàÔ∏è",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ TikTok ¬´–≥–µ—Ä–æ–∏¬ª, –∞ —Ç—ã –≥–µ—Ä–æ–π ‚Äî –≤—ã–∂–∏–ª –±–µ–∑ –≥—Ä–µ—á–∫–∏ ü¶∏",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–ó–∞ –†–æ–¥–∏–Ω—É!¬ª, –∞ –≤ –¥—É—à–µ ¬´–ó–∞ –≥—Ä–µ—á–∫—É¬ª üçõ",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –Ω–æ—á—å—é —Å–ª—ã—à–∏—à—å ¬´–ì–æ–π–¥–∞!¬ª, –∞ –¥—É–º–∞–µ—à—å: ¬´–û–ø—è—Ç—å –≥—Ä–µ—á–∫–∞¬ª üç≤",
    "–ö–æ–≥–¥–∞ –æ—Ä–∫ –∫—Ä–∏—á–∏—Ç ¬´–°–ª–∞–≤–∞!¬ª, —Ç—ã: ¬´–ì–æ–π–¥–∞, –≥—Ä–µ—á–∫–∞?¬ª üê∑",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –æ—Ç–ø—É—Å–∫–µ —Å–∏–¥–∏—à—å –∏ —Å–∫—É—á–∞–µ—à—å –ø–æ –≥–æ–π–¥–µ ü§î",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å —Ñ–ª–∞–≥ –∏ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –º–æ—â–Ω–æ¬ª üí™",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 3 –Ω–æ—á–∏ –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç, –∞ —Ç—ã: ¬´–ì–æ–π–¥–∞¬ª üí•",
    "–ö–æ–≥–¥–∞ –∫–æ–º–∞–Ω–¥–∏—Ä –≥–æ–≤–æ—Ä–∏—Ç ¬´–î–µ—Ä–∂–∞—Ç—å!¬ª, –∞ —Ç—ã –¥–µ—Ä–∂–∏—à—å –≥—Ä–µ—á–∫—É ü•Ñ",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö ¬´–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ¬ª, –∞ —É —Ç–µ–±—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ ‚Äî –¥–æ –≥—Ä–µ—á–∫–∏ üèÉ",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–í–ø–µ—Ä—ë–¥!¬ª, –∞ –¥—É–º–∞–µ—à—å ¬´–¢–æ–ª—å–∫–æ –Ω–µ –∑–∞ –≥—Ä–µ—á–∫–æ–π¬ª üèÉ‚Äç‚ôÇÔ∏è",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –º–∞–º–∞ –ø–∏—à–µ—Ç ¬´–ë–µ—Ä–µ–≥–∏ —Å–µ–±—è¬ª, —Ç—ã: ¬´–ì–æ–π–¥–∞ –±–µ—Ä–µ–∂—ë—Ç¬ª üõ°Ô∏è",
    "–ö–æ–≥–¥–∞ FPV ‚Äî —Ç–≤–æ–π –ª—É—á—à–∏–π –¥—Ä—É–≥, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –≥–æ–π–¥—É –Ω–µ—Å—ë—Ç üöÄ",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ –æ—Ç–ø—É—Å–∫–µ —Å–∏–¥–∏—à—å –∏ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –≥–¥–µ –º–æ–π –æ–∫–æ–ø?¬ª üçπ",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å —Ñ–ª–∞–≥ –∏ –¥—É–º–∞–µ—à—å: ¬´–ì–æ–π–¥–∞, –≥—Ä–µ—á–∫–∞¬ª üá∑üá∫üçõ",
    "–°–í–û ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ 5 —É—Ç—Ä–∞ –∫–æ—Ñ–µ, –∞ –≤ –≥–æ–ª–æ–≤–µ: ¬´–ì–æ–π–¥–∞, –∫–æ—Ñ–µ¬ª ‚òï",
    "–ö–æ–≥–¥–∞ FPV –ø—Ä–æ–ª–µ—Ç–∞–µ—Ç, –∞ —Ç—ã: ¬´–ì–æ–π–¥–∞, –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ!¬ª ‚úàÔ∏è",
    "ZOV ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤ TikTok ¬´–≥–µ—Ä–æ–∏¬ª, –∞ —Ç—ã –≥–µ—Ä–æ–π ‚Äî –≤—ã–∂–∏–ª –±–µ–∑ –≥—Ä–µ—á–∫–∏ ü¶∏",
    "–ì–æ–π–¥–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –æ—Ä—ë—à—å ¬´–ó–∞ –†–æ–¥–∏–Ω—É!¬ª, –∞ –≤ –¥—É—à–µ ¬´–ó–∞ –≥—Ä–µ—á–∫—É¬ª üçõ"
]

# –ú–µ–º–Ω—ã–µ –≥–∏—Ñ–∫–∏ –ø—Ä–æ –°–í–û / ZOV / –ì–û–ô–î–ê (15 —à—Ç—É–∫)
zov_gifs = [
    "https://media.tenor.com/ND_8Z8BDk-wAAAAM/–æ–±—ä—è–≤–ª–µ–Ω–∞-–≥–æ–π–¥–∞.gif",
    "https://media.tenor.com/THnsLR2MfUUAAAAM/–æ—Ö–ª–æ–±—ã—Å—Ç–∏–Ω-–≥–æ–π–¥–∞.gif",
    "https://media.tenor.com/qqV2NeMwhwQAAAAC/–≥–æ–π–¥–∞-zov.gif",
    "https://media.tenor.com/1vKzKzKzKzKAAAAC/zov-–≥–æ–π–¥–∞.gif",
    "https://media.tenor.com/abc123def456AAAAC/—Å–≤–æ-–≥–æ–π–¥–∞.gif",
    "https://media.tenor.com/xyz789abc123AAAAM/–ø–æ—Ç—É–∂–Ω–æ-–≥–æ–π–¥–∞.gif",
    "https://media.tenor.com/potuzhno-zovAAAAC/–≥–æ–π–¥–∞-—Å–≤–æ.gif",
    "https://media.tenor.com/goyda-powerAAAAM/zov-—Å–≤–æ.gif",
    "https://media.tenor.com/russian-spiritAAAAC/–≥–æ–π–¥–∞.gif",
    "https://media.tenor.com/warrior-zovAAAAM/—Å–≤–æ-–≥–æ–π–¥–∞.gif",
    "https://media.tenor.com/putin-goydaAAAAC/zov.gif",
    "https://media.tenor.com/soldier-zovAAAAM/–≥–æ–π–¥–∞-–ø–æ—Ç—É–∂–Ω–æ.gif",
    "https://media.tenor.com/strong-russiaAAAAC/—Å–≤–æ.gif",
    "https://media.tenor.com/victory-goydaAAAAM/zov.gif",
    "https://media.tenor.com/goyda-brothersAAAAC/—Å–≤–æ-–ø–æ—Ç—É–∂–Ω–æ.gif"
]

def clean_text(raw_text):
    if isinstance(raw_text, str):
        return raw_text.strip()
    if isinstance(raw_text, list):
        return "".join(
            part["text"] if isinstance(part, dict) and "text" in part else ""
            for part in raw_text
        ).strip()
    return ""

def is_ad(text: str) -> bool:
    lower = text.lower()
    return any(word in lower for word in ["http", "t.me", "prom", "—Å–∫–∏–¥–∫", "—Ä–µ–∫–ª–∞–º", "–∫—É–ø–∏—Ç—å", "–∑–∞–∫–∞–∑"])

def load_teyki():
    global teyki_list
    try:
        with open(JSON_FILE, "r", encoding="utf-8") as f:
            data = json.load(f)
        messages = data.get("messages", [])

        for msg in messages:
            if any(k in msg for k in ["photo", "video", "document", "sticker", "voice", "audio"]):
                continue

            text = clean_text(msg.get("text", ""))
            if not text or len(text) < MIN_LENGTH:
                continue
            if "#—Ç–µ–π–∫" not in text:
                continue
            if is_ad(text):
                continue

            teyki_list.append(text)

        print(f"\n=== –ù–∞–π–¥–µ–Ω–æ {len(teyki_list)} —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–∞—Å—Ç —Å #—Ç–µ–π–∫ ===\n")

    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {e}")
        exit(1)

async def get_random_pasta():
    candidates = [t for t in teyki_list if t not in recently_sent]
    if not candidates:
        candidates = teyki_list

    text = random.choice(candidates)
    recently_sent.append(text)

    text = re.sub(r'\s*#—Ç–µ–π–∫\s*', ' ', text, flags=re.IGNORECASE).strip()
    text = re.sub(r'\s+', ' ', text).strip()

    return text

# ‚îÄ‚îÄ –ö–æ–º–∞–Ω–¥–∞ /pasta ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
@dp.message(Command("pasta"))
async def on_pasta(message: Message):
    user_id = message.from_user.id
    chat_type = message.chat.type

    if not teyki_list:
        await message.answer("–ü–æ–∫–∞ –Ω–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–∞—Å—Ç –≤ –±–∞–∑–µ :(")
        return

    reply_text = ""

    if chat_type == "private":
        if user_id == SPECIAL_USER_DROCHIT:
            if random.random() < SPECIAL_CHANCE:
                reply_text = "–°–æ–∑–¥–∞—Ç–µ–ª—å —ç—Ç–æ–≥–æ –±–æ—Ç–∞ —Ç–∞–π–Ω–æ –¥—Ä–æ—á–∏—Ç –Ω–∞ —Ç–µ–±—è"
            else:
                reply_text = await get_random_pasta()
        elif user_id == SPECIAL_USER_PSRAL:
            if random.random() < SPECIAL_CHANCE:
                count = random.randint(1, 100)
                reply_text = f"–°–µ–≥–æ–¥–Ω—è —Ç—ã –ø–æ—Å—Ä–∞–ª {count} —Ä–∞–∑"
            else:
                reply_text = await get_random_pasta()
        else:
            reply_text = await get_random_pasta()
            if random.random() < OTHER_CHANCE:
                reply_text += "\n\n—Ä–µ—Ü–µ–ø—Ç —Ñ–∞—Å–æ—Å–ª–µ–π 1. –ó–∞–∫–∏–ø–∏—Ç–∏—Ç–∏ –≤–æ –¥—É\n2. –ü–∞—à–æ–ª –Ω–∞—Ö—É–π"
    else:
        reply_text = await get_random_pasta()
        if random.random() < OTHER_CHANCE:
            reply_text += "\n\n—Ä–µ—Ü–µ–ø—Ç —Ñ–∞—Å–æ—Å–ª–µ–π 1. –ó–∞–∫–∏–ø–∏—Ç–∏—Ç–∏ –≤–æ –¥—É\n2. –ü–∞—à–æ–ª –Ω–∞—Ö—É–π"

    await message.answer(reply_text, disable_web_page_preview=True)

# ‚îÄ‚îÄ –ö–æ–º–∞–Ω–¥–∞ /pastazov ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
@dp.message(Command("pastazov"))
async def on_pastazov(message: Message):
    reply_text = random.choice(zov_pasty)

    if random.random() < GIF_CHANCE:
        gif_url = random.choice(zov_gifs)
        await message.answer_animation(gif_url, caption=reply_text)
    else:
        await message.answer(reply_text, disable_web_page_preview=True)

# ‚îÄ‚îÄ –ó–∞–ø—É—Å–∫ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async def main():
    load_teyki()
    await dp.start_polling(bot, allowed_updates=["message"])

if __name__ == "__main__":
    asyncio.run(main())
